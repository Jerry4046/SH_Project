CREATE TABLE `account_tb` (
	`seq` INT(11) NOT NULL AUTO_INCREMENT,
	`uuid` VARCHAR(50) NOT NULL COLLATE 'utf8mb3_general_ci',
	`name` VARCHAR(10) NOT NULL COLLATE 'utf8mb3_general_ci',
	`password` VARCHAR(100) NOT NULL COLLATE 'utf8mb3_general_ci',
	`grade` VARCHAR(3) NULL DEFAULT 'N' COLLATE 'utf8mb3_general_ci',
	`situation` INT(11) NULL DEFAULT '0',
	PRIMARY KEY (`seq`) USING BTREE,
	UNIQUE INDEX `uuid` (`uuid`) USING BTREE
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
AUTO_INCREMENT=5
;
CREATE TABLE `client_tb` (
	`client_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`company_initial` VARCHAR(20) NOT NULL COLLATE 'utf8mb3_general_ci',
	`contact_name` VARCHAR(50) NOT NULL COLLATE 'utf8mb3_general_ci',
	`branch_name` VARCHAR(50) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`dealer_name` VARCHAR(50) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`address` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`contact_phone` VARCHAR(30) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	`updated_at` DATETIME NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
	PRIMARY KEY (`client_id`) USING BTREE,
	INDEX `idx_client_initial` (`company_initial`) USING BTREE,
	INDEX `idx_branch_name` (`branch_name`) USING BTREE
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `disposal_tb` (
	`disposal_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`product_id` BIGINT(20) NOT NULL,
	`qty` INT(11) NOT NULL,
	`reason` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`disposed_at` DATETIME NOT NULL,
	`account_seq` INT(11) NULL DEFAULT NULL,
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`disposal_id`) USING BTREE,
	INDEX `fk_disposal_product` (`product_id`) USING BTREE,
	INDEX `fk_disposal_account` (`account_seq`) USING BTREE,
	CONSTRAINT `fk_disposal_account` FOREIGN KEY (`account_seq`) REFERENCES `account_tb` (`seq`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `fk_disposal_product` FOREIGN KEY (`product_id`) REFERENCES `product_tb` (`product_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `inventory_movement_tb` (
	`movement_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`product_id` BIGINT(20) NOT NULL,
	`type` VARCHAR(20) NOT NULL COLLATE 'utf8mb3_general_ci',
	`qty` INT(11) NOT NULL,
	`related_order_id` BIGINT(20) NULL DEFAULT NULL,
	`account_seq` INT(11) NULL DEFAULT NULL,
	`remark` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`movement_id`) USING BTREE,
	INDEX `fk_inventory_product` (`product_id`) USING BTREE,
	INDEX `fk_inventory_order` (`related_order_id`) USING BTREE,
	INDEX `fk_inventory_account` (`account_seq`) USING BTREE,
	CONSTRAINT `fk_inventory_account` FOREIGN KEY (`account_seq`) REFERENCES `account_tb` (`seq`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `fk_inventory_order` FOREIGN KEY (`related_order_id`) REFERENCES `order_tb` (`order_id`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `fk_inventory_product` FOREIGN KEY (`product_id`) REFERENCES `product_tb` (`product_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `invoice_tb` (
	`invoice_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`order_id` BIGINT(20) NOT NULL,
	`status` VARCHAR(20) NOT NULL COLLATE 'utf8mb3_general_ci',
	`invoice_number` VARCHAR(50) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`printed_at` DATETIME NULL DEFAULT NULL,
	`shipped_at` DATETIME NULL DEFAULT NULL,
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`invoice_id`) USING BTREE,
	INDEX `fk_invoice_order` (`order_id`) USING BTREE,
	CONSTRAINT `fk_invoice_order` FOREIGN KEY (`order_id`) REFERENCES `order_tb` (`order_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `order_item_tb` (
	`order_item_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`order_id` BIGINT(20) NOT NULL,
	`product_id` BIGINT(20) NOT NULL,
	`qty` INT(11) NOT NULL,
	`unit_price` DECIMAL(15,2) NOT NULL,
	PRIMARY KEY (`order_item_id`) USING BTREE,
	INDEX `fk_order_item_order` (`order_id`) USING BTREE,
	INDEX `fk_order_item_product` (`product_id`) USING BTREE,
	CONSTRAINT `fk_order_item_order` FOREIGN KEY (`order_id`) REFERENCES `order_tb` (`order_id`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `fk_order_item_product` FOREIGN KEY (`product_id`) REFERENCES `product_tb` (`product_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `order_tb` (
	`order_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`client_id` BIGINT(20) NOT NULL,
	`order_date` DATETIME NOT NULL,
	`status` VARCHAR(20) NOT NULL COLLATE 'utf8mb3_general_ci',
	`total_amount` DECIMAL(15,2) NULL DEFAULT '0.00',
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	`updated_at` DATETIME NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
	PRIMARY KEY (`order_id`) USING BTREE,
	INDEX `fk_order_client` (`client_id`) USING BTREE,
	CONSTRAINT `fk_order_client` FOREIGN KEY (`client_id`) REFERENCES `client_tb` (`client_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `price_tb` (
	`price_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`product_id` BIGINT(20) NOT NULL,
	`price` DECIMAL(18,2) NOT NULL,
	`currency` VARCHAR(3) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`reason` TEXT NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	`updated_at` DATETIME NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
	`account_seq` INT(11) NOT NULL,
	PRIMARY KEY (`price_id`) USING BTREE,
	INDEX `ix_price_product` (`product_id`) USING BTREE,
	INDEX `ix_price_account` (`account_seq`) USING BTREE,
	CONSTRAINT `fk_price__account` FOREIGN KEY (`account_seq`) REFERENCES `account_tb` (`seq`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `fk_price__product` FOREIGN KEY (`product_id`) REFERENCES `product_tb` (`product_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `product_code_tb` (
	`code_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`company_initial` VARCHAR(20) NOT NULL COLLATE 'utf8mb3_general_ci',
	`type_code` VARCHAR(50) NOT NULL COLLATE 'utf8mb3_general_ci',
	`category_code` VARCHAR(50) NOT NULL COLLATE 'utf8mb3_general_ci',
	`description` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	PRIMARY KEY (`code_id`) USING BTREE,
	UNIQUE INDEX `uk_product_code` (`company_initial`, `type_code`, `category_code`) USING BTREE
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `product_tb` (
	`product_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`registrant_seq` INT(11) NOT NULL,
	`product_code` BIGINT(20) NOT NULL,
	`item_code` VARCHAR(100) NOT NULL COLLATE 'utf8mb3_general_ci',
	`product_name` VARCHAR(100) NOT NULL COLLATE 'utf8mb3_general_ci',
	`description` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`change_reason` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	`updated_at` DATETIME NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
	PRIMARY KEY (`product_id`) USING BTREE,
	UNIQUE INDEX `uk_product_item_code` (`item_code`) USING BTREE,
	INDEX `fk_product_registrant` (`registrant_seq`) USING BTREE,
	INDEX `fk_product_code` (`product_code`) USING BTREE,
	CONSTRAINT `fk_product_code` FOREIGN KEY (`product_code`) REFERENCES `product_code_tb` (`code_id`) ON UPDATE RESTRICT ON DELETE RESTRICT,
	CONSTRAINT `fk_product_registrant` FOREIGN KEY (`registrant_seq`) REFERENCES `account_tb` (`seq`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `sales_tb` (
	`sale_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`order_id` BIGINT(20) NOT NULL,
	`sale_date` DATETIME NOT NULL,
	`amount` DECIMAL(15,2) NOT NULL,
	`tax` DECIMAL(15,2) NULL DEFAULT '0.00',
	`discount` DECIMAL(15,2) NULL DEFAULT '0.00',
	`final_amount` DECIMAL(15,2) NOT NULL,
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`sale_id`) USING BTREE,
	INDEX `fk_sales_order` (`order_id`) USING BTREE,
	CONSTRAINT `fk_sales_order` FOREIGN KEY (`order_id`) REFERENCES `order_tb` (`order_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `stock_history_tb` (
	`history_id` BIGINT(20) NOT NULL AUTO_INCREMENT,
	`product_id` BIGINT(20) NOT NULL,
	`change_type` VARCHAR(20) NOT NULL COLLATE 'utf8mb3_general_ci',
	`change_qty` INT(11) NOT NULL,
	`old_total_qty` INT(11) NOT NULL,
	`new_total_qty` INT(11) NOT NULL,
	`reason` VARCHAR(255) NULL DEFAULT NULL COLLATE 'utf8mb3_general_ci',
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	PRIMARY KEY (`history_id`) USING BTREE,
	INDEX `fk_stock_history_product` (`product_id`) USING BTREE,
	CONSTRAINT `fk_stock_history_product` FOREIGN KEY (`product_id`) REFERENCES `product_tb` (`product_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
CREATE TABLE `stock_tb` (
	`product_id` BIGINT(20) NOT NULL,
	`pieces_per_pack` INT(11) NOT NULL,
	`total_qty` INT(11) NOT NULL,
	`pack_qty` INT(11) NOT NULL,
	`single_qty` INT(11) NOT NULL,
	`created_at` DATETIME NULL DEFAULT current_timestamp(),
	`updated_at` DATETIME NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
	PRIMARY KEY (`product_id`) USING BTREE,
	CONSTRAINT `fk_stock_product` FOREIGN KEY (`product_id`) REFERENCES `product_tb` (`product_id`) ON UPDATE RESTRICT ON DELETE RESTRICT
)
COLLATE='utf8mb3_general_ci'
ENGINE=InnoDB
;
